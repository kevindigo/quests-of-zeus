<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Quests of Zeus - A board game PWA">
    <meta name="theme-color" content="#1a202c">

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico">

    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="/assets/icon-192.png">

    <title>Quests of Zeus</title>

    <!-- External CSS -->
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <div class="container">
      <h1>Quests of Zeus</h1>
      <p class="subtitle">A Playable Board Game Implementation</p>

      <div class="game-message" id="gameMessage"></div>

      <div class="game-layout">
        <!-- Left Panel: Player Info & Actions -->
        <div class="game-panel">
          <div id="playerInfo"></div>
          <div id="phaseDisplay" style="margin-top: 1.5rem"></div>
        </div>

        <!-- Center Panel: Game Map -->
        <div class="hex-map-container">
          <div class="svg-controls">
            <button id="toggleCoordinates">Show Coordinates</button>
            <button id="toggleLabels">Show Labels</button>
            <button id="zoomIn">Zoom In</button>
            <button id="zoomOut">Zoom Out</button>
            <button id="resetZoom">Reset Zoom</button>
            <button id="newGame">New Game</button>
          </div>
          <div id="hexMapSVG"></div>
        </div>
      </div>

      <footer>
        <p>
          Quests of Zeus is copyright 2025 by Kevin B. Smith This game was
          heavily inspired by the board game The Oracle of Delphi, designed by
          Stefan Feld and copyright 2016 by Hall Games. This project is an
          independent work not affiliated with or endorsed by the original
          publisher or designer.
        </p>
      </footer>
    </div>

    <script type="module">
      import { GameController } from './dist/game-controller.js';

      // Initialize the game controller
      const gameController = new GameController();

      document.addEventListener('DOMContentLoaded', () => {
        console.log('Page loaded, initializing game...');
        gameController.initializeGameUI();
      });

      // SVG Controls
      let currentOptions = {
        showCoordinates: false,
        showTerrainLabels: false,
        cellSize: 30,
      };

      document.getElementById('toggleCoordinates').addEventListener(
        'click',
        () => {
          currentOptions.showCoordinates = !currentOptions
            .showCoordinates;
          document.getElementById('toggleCoordinates').textContent =
            currentOptions.showCoordinates
              ? 'Hide Coordinates'
              : 'Show Coordinates';
          // Note: This would need to be integrated with the game controller
        },
      );

      document.getElementById('toggleLabels').addEventListener(
        'click',
        () => {
          currentOptions.showTerrainLabels = !currentOptions
            .showTerrainLabels;
          document.getElementById('toggleLabels').textContent =
            currentOptions.showTerrainLabels
              ? 'Hide Labels'
              : 'Show Labels';
          // Note: This would need to be integrated with the game controller
        },
      );

      document.getElementById('zoomIn').addEventListener(
        'click',
        () => {
          currentOptions.cellSize = Math.min(
            currentOptions.cellSize + 5,
            60,
          );
          // Note: This would need to be integrated with the game controller
        },
      );

      document.getElementById('zoomOut').addEventListener(
        'click',
        () => {
          currentOptions.cellSize = Math.max(
            currentOptions.cellSize - 5,
            20,
          );
          // Note: This would need to be integrated with the game controller
        },
      );

      document.getElementById('resetZoom').addEventListener(
        'click',
        () => {
          currentOptions.cellSize = 30;
          // Note: This would need to be integrated with the game controller
        },
      );

      document.getElementById('newGame').addEventListener(
        'click',
        () => {
          if (
            confirm('Start a new game? Current progress will be lost.')
          ) {
            gameController.startNewGame();
          }
        },
      );

      // Service Worker Registration
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then((registration) => {
              console.log('SW registered: ', registration);
            })
            .catch((registrationError) => {
              console.log(
                'SW registration failed: ',
                registrationError,
              );
            });
        });
      }

      // PWA Installation
      let deferredPrompt;
      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        console.log('PWA installation available');
      });
    </script>
  </body>
</html>
