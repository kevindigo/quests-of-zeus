<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Quests of Zeus - A board game PWA">
    <meta name="theme-color" content="#1a202c">

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico">

    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="/assets/icon-192.png">

    <title>Quests of Zeus</title>

    <!-- External CSS -->
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <div class="container">
      <h2>Quests of Zeus</h2>
      <p class="subtitle">A Playable Board Game Implementation</p>

      <div class="game-message" id="gameMessage"></div>

      <div class="game-layout">
        <!-- Left Panel: Player Info & Actions -->
        <div class="game-panel">
          <div id="playerInfo"></div>
        </div>

        <div id="phaseDisplay" class="phase-display"></div>
        <!-- Center Panel: Game Map -->
        <div class="hex-map-container">
          <div id="hexMapSVG"></div>
          <div class="svg-controls">
            <button id="newGame" class="action-button">Start New Game</button>
          </div>
        </div>
      </div>

      <footer>
        <p>
          Quests of Zeus is copyright 2025 by Kevin B. Smith This game was
          heavily inspired by the board game The Oracle of Delphi, designed by
          Stefan Feld and copyright 2016 by Hall Games. This project is an
          independent work not affiliated with or endorsed by the original
          publisher or designer.
        </p>
      </footer>
    </div>

    <script type="module">
      import { Controller } from './dist/Controller.js';

      // Initialize the game controller
      const gameController = new Controller();

      document.addEventListener('DOMContentLoaded', () => {
        console.log('Page loaded, initializing game...');
        gameController.initializeGameUI();
      });

      // SVG Controls
      let currentOptions = {
        showCoordinates: false,
        showTerrainLabels: false,
        cellSize: 30,
      };

      document.getElementById('newGame').addEventListener(
        'click',
        () => {
          if (
            confirm('Start a new game? Current progress will be lost.')
          ) {
            gameController.startNewGame();
          }
        },
      );

      // Service Worker Registration
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then((registration) => {
              console.log('SW registered: ', registration);
            })
            .catch((registrationError) => {
              console.log(
                'SW registration failed: ',
                registrationError,
              );
            });
        });
      }

      // PWA Installation
      let deferredPrompt;
      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        console.log('PWA installation available');
      });
    </script>
  </body>
</html>
