<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Quests of Zeus - A board game PWA">
    <meta name="theme-color" content="#1a202c">

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico">

    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="/assets/icon-192.png">

    <title>Quests of Zeus</title>

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        color: white;
      }

      .container {
        text-align: center;
        padding: 2rem;
        max-width: 1400px;
        width: 100%;
      }

      h1 {
        font-size: 3rem;
        margin-bottom: 1rem;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .subtitle {
        font-size: 1.2rem;
        margin-bottom: 2rem;
        opacity: 0.9;
      }

      .game-layout {
        display: grid;
        grid-template-columns: 300px 1fr 300px;
        gap: 1rem;
        margin: 2rem 0;
        align-items: start;
      }

      .game-panel {
        background: rgba(255, 255, 255, 0.1);
        padding: 1.5rem;
        border-radius: 8px;
        backdrop-filter: blur(10px);
        text-align: left;
      }

      .game-panel h3 {
        margin-bottom: 1rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        padding-bottom: 0.5rem;
      }

      .player-info .player-stats {
        display: grid;
        gap: 0.5rem;
        margin-bottom: 1rem;
      }

      .offering-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 0.5rem;
        margin-top: 0.5rem;
      }

      .offering-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.25rem;
        border-radius: 4px;
      }

      .color-swatch {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        border: 1px solid rgba(255, 255, 255, 0.3);
      }

      .dice-container {
        display: flex;
        gap: 0.5rem;
        margin-top: 0.5rem;
        flex-wrap: wrap;
      }

      .die {
        width: 30px;
        height: 30px;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: white;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.3);
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .die:hover {
        transform: scale(1.1);
        box-shadow: 0 0 8px rgba(255, 255, 255, 0.5);
      }

      .die.selected-die {
        border: 3px solid #ffffff;
        box-shadow: 0 0 12px rgba(255, 255, 255, 0.8);
        transform: scale(1.15);
      }

      .selected-die-info {
        margin-top: 0.5rem;
        padding: 0.5rem;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        flex-wrap: wrap;
      }

      .no-dice {
        font-style: italic;
        opacity: 0.7;
      }

      .quest-list {
        display: grid;
        gap: 0.5rem;
        margin-top: 0.5rem;
      }

      .quest-item {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 0.5rem;
        padding: 0.5rem;
        border-radius: 4px;
        background: rgba(255, 255, 255, 0.1);
        font-size: 0.9rem;
      }

      .quest-type {
        font-weight: bold;
      }

      .quest-color {
        padding: 0.1rem 0.5rem;
        border-radius: 12px;
        font-size: 0.8rem;
        text-align: center;
      }

      .quest-progress {
        margin-top: 1rem;
      }

      .recolor-section {
        background: rgba(255, 255, 255, 0.1);
        padding: 1rem;
        border-radius: 6px;
        margin-top: 1rem;
      }

      .recolor-option {
        padding: 0.5rem;
        border-radius: 4px;
        transition: background-color 0.2s;
      }

      .recolor-option:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      .recolor-option input[type="radio"] {
        margin-right: 0.5rem;
      }

      .recolor-option label {
        cursor: pointer;
        font-size: 0.9rem;
      }

      .quest-types {
        display: grid;
        gap: 0.25rem;
        margin-top: 0.5rem;
      }

      .quest-type-item {
        display: flex;
        justify-content: space-between;
        padding: 0.25rem 0.5rem;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
        font-size: 0.9rem;
      }

      .phase-info {
        text-align: center;
      }

      .phase-actions {
        margin-top: 1rem;
      }

      .action-btn {
        background: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.3);
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s;
        font-size: 1rem;
        margin: 0.25rem;
      }

      .action-btn:hover:not(:disabled) {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-1px);
      }

      .action-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .action-btn.secondary {
        background: rgba(255, 255, 255, 0.1);
        font-size: 0.9rem;
        padding: 0.5rem 1rem;
      }

      .hex-map-container {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        padding: 1rem;
        backdrop-filter: blur(10px);
        overflow: auto;
        max-height: 800px;
      }

      .hex-map-svg {
        display: block;
        margin: 0 auto;
        max-width: 100%;
        height: auto;
      }

      .svg-controls {
        display: flex;
        gap: 0.5rem;
        justify-content: center;
        margin-bottom: 1rem;
        flex-wrap: wrap;
      }

      .svg-controls button {
        font-size: 0.8rem;
        padding: 0.3rem 0.6rem;
      }

      .game-message {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 1rem 2rem;
        border-radius: 8px;
        z-index: 1000;
        display: none;
      }

      /* Hex cell styles */
      .hex-cell {
        transition: all 0.2s ease;
      }

      .hex-cell-inner {
        pointer-events: none;
      }

      .hex-cell:hover {
        filter: brightness(1.1);
        stroke-width: 2;
      }

      .hex-cell.selected {
        stroke-width: 3;
        stroke: #ff0000;
      }

      .hex-highlight.available-move {
        stroke: #ffffff !important;
        stroke-width: 2 !important;
        stroke-dasharray: 4, 3 !important;
        filter: brightness(1.2);
        animation: pulse-dash 1.5s infinite;
      }

      .hex-highlight.available-move-favor {
        stroke: #c0c0c0 !important;
        stroke-width: 2 !important;
        stroke-dasharray: 1, 5 !important;
        filter: brightness(1.2);
        animation: pulse-dot 1.5s infinite;
      }

      @keyframes pulse-dash {
        0% {
          stroke-dashoffset: 0;
        }
        100% {
          stroke-dashoffset: 10;
        }
      }

      @keyframes pulse-dot {
        0% {
          stroke-dashoffset: 0;
        }
        100% {
          stroke-dashoffset: 12;
        }
      }

      .cube-count {
        font-weight: bold;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
      }

      .colored-cube {
        filter: drop-shadow(2px 2px 3px rgba(0, 0, 0, 0.5));
      }

      .hex-coord, .hex-terrain-label {
        pointer-events: none;
        user-select: none;
      }

      .greek-god-head {
        pointer-events: none;
        user-select: none;
      }

      .player-marker {
        pointer-events: none;
        animation: pulse 2s infinite;
        z-index: 10;
        filter: drop-shadow(1px 1px 2px rgba(0, 0, 0, 0.5));
      }

      @keyframes pulse {
        0% {
          r: 8;
        }
        50% {
          r: 10;
        }
        100% {
          r: 8;
        }
      }

      /* Color classes for UI elements */
      .color-red {
        background: rgba(220, 20, 60, 0.3);
      }
      .color-pink {
        background: rgba(255, 105, 180, 0.3);
      }
      .color-blue {
        background: rgba(0, 0, 255, 0.3);
      }
      .color-black {
        background: rgba(0, 0, 0, 0.3);
        color: white;
      }
      .color-green {
        background: rgba(0, 128, 0, 0.3);
      }
      .color-yellow {
        background: rgba(255, 255, 0, 0.3);
      }

      /* Quest type backgrounds */
      .quest-offering {
        background: rgba(144, 238, 144, 0.2);
      }
      .quest-monster {
        background: rgba(178, 34, 34, 0.2);
      }
      .quest-temple {
        background: rgba(255, 215, 0, 0.2);
      }
      .quest-foundation {
        background: rgba(139, 69, 19, 0.2);
      }
      .quest-cloud {
        background: rgba(135, 206, 250, 0.2);
      }

      footer {
        margin-top: 2rem;
        opacity: 0.7;
        font-size: 0.9rem;
      }

      /* Welcome screen styles */
      .welcome-screen {
        text-align: center;
      }

      .welcome-screen h3 {
        font-size: 2rem;
        margin-bottom: 1rem;
        color: white;
      }

      .welcome-screen p {
        font-size: 1.2rem;
        margin-bottom: 2rem;
        opacity: 0.9;
      }

      .game-info {
        margin-top: 2rem;
        text-align: left;
        background: rgba(255, 255, 255, 0.1);
        padding: 1.5rem;
        border-radius: 8px;
      }

      .game-info h4 {
        margin-bottom: 1rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        padding-bottom: 0.5rem;
      }

      .game-info ul {
        list-style-type: none;
        padding-left: 0;
      }

      .game-info li {
        margin-bottom: 0.5rem;
        padding-left: 1.5rem;
        position: relative;
      }

      .game-info li:before {
        content: "â€¢";
        position: absolute;
        left: 0;
        color: white;
        font-weight: bold;
      }

      .game-rules {
        text-align: left;
      }

      .rules-section {
        margin-top: 1rem;
      }

      .rules-section ul {
        list-style-type: none;
        padding-left: 0;
      }

      .rules-section li {
        margin-bottom: 0.5rem;
        padding-left: 1rem;
      }

      .welcome-map {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 400px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        border: 2px dashed rgba(255, 255, 255, 0.2);
      }

      .welcome-map p {
        font-size: 1.1rem;
        opacity: 0.7;
      }

      @media (max-width: 1200px) {
        .game-layout {
          grid-template-columns: 1fr;
          grid-template-rows: auto auto auto;
        }

        .game-panel {
          order: 1;
        }

        .hex-map-container {
          order: 2;
        }

        .quest-panel {
          order: 3;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Quests of Zeus</h1>
      <p class="subtitle">A Playable Board Game Implementation</p>

      <div class="game-message" id="gameMessage"></div>

      <div class="game-layout">
        <!-- Left Panel: Player Info & Actions -->
        <div class="game-panel">
          <div id="playerInfo"></div>
          <div id="phaseDisplay" style="margin-top: 1.5rem"></div>
        </div>

        <!-- Center Panel: Game Map -->
        <div class="hex-map-container">
          <div class="svg-controls">
            <button id="toggleCoordinates">Show Coordinates</button>
            <button id="toggleLabels">Show Labels</button>
            <button id="zoomIn">Zoom In</button>
            <button id="zoomOut">Zoom Out</button>
            <button id="resetZoom">Reset Zoom</button>
            <button id="newGame">New Game</button>
          </div>
          <div id="hexMapSVG"></div>
        </div>

        <!-- Right Panel: Quests -->
        <div class="game-panel quest-panel">
          <div id="questInfo"></div>
        </div>
      </div>

      <footer>
        <p>
          Quests of Zeus is copyright 2025 by Kevin B. Smith
          This game was heavily inspired by the board game The Oracle of Delphi, designed by Stefan Feld and copyright 2016 by Hall Games.
          This project is an independent work not affiliated with or endorsed by the original publisher or designer.
        </p>
      </footer>
    </div>

    <script type="module">
      import { GameController } from "./dist/game-controller.js";

      // Initialize the game controller
      const gameController = new GameController();

      document.addEventListener("DOMContentLoaded", () => {
        console.log("Page loaded, initializing game...");
        gameController.initializeGameUI();
      });

      // SVG Controls
      let currentOptions = {
        showCoordinates: false,
        showTerrainLabels: false,
        cellSize: 30,
      };

      document.getElementById("toggleCoordinates").addEventListener(
        "click",
        () => {
          currentOptions.showCoordinates = !currentOptions
            .showCoordinates;
          document.getElementById("toggleCoordinates").textContent =
            currentOptions.showCoordinates
              ? "Hide Coordinates"
              : "Show Coordinates";
          // Note: This would need to be integrated with the game controller
        },
      );

      document.getElementById("toggleLabels").addEventListener(
        "click",
        () => {
          currentOptions.showTerrainLabels = !currentOptions
            .showTerrainLabels;
          document.getElementById("toggleLabels").textContent =
            currentOptions.showTerrainLabels
              ? "Hide Labels"
              : "Show Labels";
          // Note: This would need to be integrated with the game controller
        },
      );

      document.getElementById("zoomIn").addEventListener(
        "click",
        () => {
          currentOptions.cellSize = Math.min(
            currentOptions.cellSize + 5,
            60,
          );
          // Note: This would need to be integrated with the game controller
        },
      );

      document.getElementById("zoomOut").addEventListener(
        "click",
        () => {
          currentOptions.cellSize = Math.max(
            currentOptions.cellSize - 5,
            20,
          );
          // Note: This would need to be integrated with the game controller
        },
      );

      document.getElementById("resetZoom").addEventListener(
        "click",
        () => {
          currentOptions.cellSize = 30;
          // Note: This would need to be integrated with the game controller
        },
      );

      document.getElementById("newGame").addEventListener(
        "click",
        () => {
          if (
            confirm("Start a new game? Current progress will be lost.")
          ) {
            gameController.startNewGame();
          }
        },
      );

      // Service Worker Registration
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker.register("/sw.js")
            .then((registration) => {
              console.log("SW registered: ", registration);
            })
            .catch((registrationError) => {
              console.log(
                "SW registration failed: ",
                registrationError,
              );
            });
        });
      }

      // PWA Installation
      let deferredPrompt;
      window.addEventListener("beforeinstallprompt", (e) => {
        e.preventDefault();
        deferredPrompt = e;
        console.log("PWA installation available");
      });
    </script>
  </body>
</html>
